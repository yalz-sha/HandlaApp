{"ast":null,"code":"import React,{useEffect,useState}from'react';import'../styles/OrderHistory.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const OrderHistory=()=>{const[orders,setOrders]=useState([]);const[selectedOrder,setSelectedOrder]=useState(null);const[orderItems,setOrderItems]=useState([]);useEffect(()=>{const fetchOrders=async()=>{console.log('Fetching');const token=localStorage.getItem('token');const userId=parseInt(localStorage.getItem(\"userId\"),10);if(!token||isNaN(userId)){console.error('User is not authenticated or userId is invalid.');return;}try{const response=await fetch(\"https://localhost:44342/api/orders/\".concat(userId),{headers:{Authorization:\"Bearer \".concat(token)}});if(!response.ok){throw new Error('Failed to fetch orders');}const data=await response.json();setOrders(data);}catch(error){console.error('Error fetching orders:',error);}};fetchOrders();},[]);const fetchOrderItems=async id=>{const token=localStorage.getItem('token');try{const response=await fetch(\"https://localhost:44342/api/orders/orderById/\".concat(id),{headers:{Authorization:\"Bearer \".concat(token)}});if(!response.ok){throw new Error('Failed to fetch order items');}const data=await response.json();setOrderItems(data);setSelectedOrder(id);}catch(error){console.error('Error fetching order items:',error);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"order-history\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Order History\"}),orders.map(order=>/*#__PURE__*/_jsxs(\"div\",{className:\"order\",onClick:()=>fetchOrderItems(order.id),children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Order #\",order.id]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Status:\"}),\" \",order.status]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Total:\"}),\" $\",order.total_Price.toFixed(2)]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Ordered on:\"}),\" \",new Date(order.created_At).toLocaleDateString()]}),selectedOrder===order.id&&/*#__PURE__*/_jsxs(\"div\",{className:\"order-items\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Order Items\"}),/*#__PURE__*/_jsx(\"ul\",{children:orderItems.map(item=>/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Product:\"}),\" \",item.product_Name]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Quantity:\"}),\" \",item.quantity]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Price:\"}),\" $\",item.price.toFixed(2)]})]},item.id))})]})]},order.id))]});};export default OrderHistory;","map":{"version":3,"names":["React","useEffect","useState","jsx","_jsx","jsxs","_jsxs","OrderHistory","orders","setOrders","selectedOrder","setSelectedOrder","orderItems","setOrderItems","fetchOrders","console","log","token","localStorage","getItem","userId","parseInt","isNaN","error","response","fetch","concat","headers","Authorization","ok","Error","data","json","fetchOrderItems","id","className","children","map","order","onClick","status","total_Price","toFixed","Date","created_At","toLocaleDateString","item","product_Name","quantity","price"],"sources":["C:/Sivayalini/HandlaApp/handla-frontend/src/components/OrderHistory.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport '../styles/OrderHistory.css';\r\n\r\nconst OrderHistory = () => {\r\n  const [orders, setOrders] = useState([]);\r\n  const [selectedOrder, setSelectedOrder] = useState(null);\r\n  const [orderItems, setOrderItems] = useState([]);\r\n\r\n  useEffect(() => {\r\n    const fetchOrders = async () => {\r\n      console.log('Fetching')\r\n      const token = localStorage.getItem('token');\r\n      const userId = parseInt(localStorage.getItem(\"userId\"), 10);\r\n\r\n      if (!token || isNaN(userId)) {\r\n        console.error('User is not authenticated or userId is invalid.');\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const response = await fetch(`https://localhost:44342/api/orders/${userId}`, {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`\r\n          }\r\n        });\r\n\r\n        if (!response.ok) {\r\n          throw new Error('Failed to fetch orders');\r\n        }\r\n\r\n        const data = await response.json();\r\n        setOrders(data);\r\n      } catch (error) {\r\n        console.error('Error fetching orders:', error);\r\n      }\r\n    };\r\n\r\n    fetchOrders();\r\n  }, []);\r\n\r\n  const fetchOrderItems = async (id) => {\r\n    const token = localStorage.getItem('token');\r\n\r\n    try {\r\n      const response = await fetch(`https://localhost:44342/api/orders/orderById/${id}`, {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`\r\n        }\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to fetch order items');\r\n      }\r\n\r\n      const data = await response.json();\r\n      setOrderItems(data);\r\n      setSelectedOrder(id);\r\n    } catch (error) {\r\n      console.error('Error fetching order items:', error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"order-history\">\r\n      <h2>Order History</h2>\r\n      {orders.map(order => (\r\n        <div key={order.id} className=\"order\" onClick={() => fetchOrderItems(order.id)}>\r\n          <h3>Order #{order.id}</h3>\r\n          <p><span>Status:</span> {order.status}</p>\r\n          <p><span>Total:</span> ${order.total_Price.toFixed(2)}</p>\r\n          <p><span>Ordered on:</span> {new Date(order.created_At).toLocaleDateString()}</p>\r\n          {selectedOrder === order.id && (\r\n            <div className=\"order-items\">\r\n              <h4>Order Items</h4>\r\n              <ul>\r\n                {orderItems.map(item => (\r\n                  <li key={item.id}>\r\n                    <p><span>Product:</span> {item.product_Name}</p>\r\n                    <p><span>Quantity:</span> {item.quantity}</p>\r\n                    <p><span>Price:</span> ${item.price.toFixed(2)}</p>\r\n                  </li>\r\n                ))}\r\n              </ul>\r\n            </div>\r\n          )}\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OrderHistory;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}